<script>
    $(document).ready(function() {
        const $overlay = $("#overlay");
        const $popup = $("#popup");
        const $gifWrap = $("#gif-wrap");

        // Giphy API defaults
        const giphy = {
            baseURL: "https://api.giphy.com/v1/gifs/",
            apiKey: "0UTRbFtkMxAplrohufYco5IY74U8hOes",
            tag: "awesome",
            type: "random",
            rating: "pg-13"
        };

        // Function to fetch and render a new GIF
        const fetchAndRenderGif = () => {
            // Giphy API URL
            let giphyURL = encodeURI(
                giphy.baseURL +
                giphy.type +
                "?api_key=" +
                giphy.apiKey +
                "&tag=" +
                giphy.tag +
                "&rating=" +
                giphy.rating
            );

            // Call Giphy API and render data
            $.getJSON(giphyURL, json => renderGif(json.data));
        };

        // Display Gif in gif wrap container
        const renderGif = _giphy => {
            console.log(_giphy);
            // Set gif as bg image
            $gifWrap.css({
                "background-image": 'url("' + _giphy.images.original.url + '")'
            });

            // Show overlay and popup
            $overlay.show();
            $popup.show();
        };

        // Listen for Calendly event when an appointment is scheduled
        Calendly.initInlineWidgets();
        Calendly.on('calendly.event_scheduled', function(data) {
            console.log('Appointment scheduled:', data);
            // Call fetchAndRenderGif when an appointment is scheduled
            fetchAndRenderGif();
        });

        // Close popup when clicking on overlay
        $overlay.click(function() {
            $overlay.hide();
            $popup.hide();
        });
    });
</script>
